### å®‰è£…
```
install.packages("BiocManager")
library(BiocManager)
BiocManager::install("methyLkit")
```
### ä½¿ç”¨
methyLkitæ”¯æŒä¸¤ç§æ–‡ä»¶çš„è¾“å…¥
* çº¯æ–‡æœ¬æ ¼å¼
* bam


çº¯æ–‡æœ¬æ ¼å¼çš„æ–‡ä»¶ï¼Œå…¶å†…å®¹éµå¾ªå¦‚ä¸‹æ ¼å¼  
```
chrBase chr base strand coverage freqC freqT 
chr21.9764539 chr21 9764539 R 12 25.00 75.00 
chr21.9764513 chr21 9764513 R 12 0.00 100.00 
chr21.9820622 chr21 9820622 F 13 0.00 100.00 
chr21.9837545 chr21 9837545 F 11 0.00 100.00 
chr21.9849022 chr21 9849022 F 124 72.58 27.42 
chr21.9853326 chr21 9853326 F 17 70.59 29.41 
```
æ¯ä¸€è¡Œæ˜¯ä¸€ä¸ªç”²åŸºåŒ–ä½ç‚¹ï¼Œcoverage ä»£è¡¨è¦†ç›–è¿™ä¸ªä½ç‚¹çš„readsæ•°ï¼ŒfreqC ä»£è¡¨ç”²åŸºåŒ–Cçš„æ¯”ä¾‹ï¼ŒfreqT ä»£è¡¨éç”²åŸºåŒ–Cçš„æ¯”ä¾‹ã€‚è¿™ç§çº¯æ–‡æœ¬æ ¼å¼å†…å®¹éå¸¸ç›´è§‚ï¼Œæ–‡ä»¶å¤§å°ç›¸æ¯”bam æ–‡ä»¶å°å¾ˆå¤šï¼Œè¯»å–çš„é€Ÿåº¦æ›´å¿«ã€‚
#### è¯»å–
* çº¯æ–‡æœ¬çš„æ–‡ä»¶çš„è¯»å–
```
library(methylkit)

//file.listè¿™é‡Œå­˜æ”¾çš„æ˜¯æ¯ä¸ªæ ·å“çš„çº¯æ–‡æœ¬æ–‡ä»¶çš„è·¯å¾„
file.list = list("sample_A1.txt",
		"sample_A2.txt",
		"sample_B1.txt",
		"sample_B2.txt"
		)

//idæ˜¯ç»™æ¯ä¸ªæ–‡æœ¬æ–‡ä»¶èµ‹äºˆä¸€ä¸ªå¯¹åº”çš„id
id = list(
		"sample_A1",
		"sample_A2",
		"sample_B1",
		"sample_B2"
		)


myobj = methRead(
		location = file.list,
		sample_id = id,
		assembly = "hg19",         //è¿™ä¸ªå‚æ•°æ˜¯æè¿°åŸºå› ç»„çš„ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå¯ä»¥æ˜¯ä»»ä½•å€¼
		treatment = c(1,1,0,0),    //åœ¨è¿™é‡Œï¼Œ1ä»£è¡¨å®éªŒç»„ï¼Œ0ä»£è¡¨å¯¹ç…§ç»„
		context="CpG"
		)
```
* bamæ–‡ä»¶  
å…¶å®bamæ–‡ä»¶çš„è¯»å–è·Ÿä¸Šé¢åŒºåˆ«ä¸å¤§ï¼Œå°±æ˜¯ç”¨äº†ä¸ªåˆ«çš„å‡½æ•°
```
library(methylkit)

//file.listçš„ä½œç”¨åŒä¸Š
file.list = list("sample_A1.bam",
		"sample_A2.bam",
		"sample_B1.bam",
		"sample_B2.bam"
		)

//ä¹ŸåŒä¸Š
id = list(
		"sample_A1",
		"sample_A2",
		"sample_B1",
		"sample_B2"
		)


myobj = processBismarkAln(
		location = file.list,
		sample_id = id,
		assembly = "hg19",         //è¿™ä¸ªå‚æ•°æ˜¯æè¿°åŸºå› ç»„çš„ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå¯ä»¥æ˜¯ä»»ä½•å€¼
		treatment = c(1,1,0,0),    //åœ¨è¿™é‡Œï¼Œ1ä»£è¡¨å®éªŒç»„ï¼Œ0ä»£è¡¨å¯¹ç…§ç»„
		context="CpG",
		save.folder = getwd()      //æš‚æ—¶ä¸æ¸…æ¥šä¸ºå•¥åŠ è¿™ä¸œè¥¿
		)
```
#### åˆå¹¶æ‰€æœ‰æƒ…å†µï¼Œå¾—åˆ°æ‰€æœ‰æ ·æœ¬çš„ç”²åŸºåŒ–è¡¨è¾¾è°±
å¾ˆç®€å•ï¼Œåªç”¨ä¸€ä¸ªå‡½æ•°  
`meth=unite(myobj, destrand=FALSE)`  
æ‰€å¾—çš„methå¯ä»¥è¿™æ ·çœ‹  
`head(meth)`  
å®é™…ä¸Šå°±æ˜¯ä¸Šé¢æ ·å“æ–‡ä»¶æ‰€å«ä¿¡æ¯çš„åˆå¹¶
#### å·®å¼‚åŒ–ä½ç‚¹åˆ†æ
`myDiff=calculateDiffMeth(meth)`  
æ ¹æ®ç”²åŸºåŒ–Cæ˜¯å˜å¤šäº†è¿˜æ˜¯å˜å°‘äº†ï¼Œå¯ä»¥å°†å·®å¼‚ç”²åŸºåŒ–çš„ç»“æœåˆ†ä¸ºä¸¤å¤§ç±»ï¼š
* **hypermethylated**
* **hypomethylated** 

**hypermethylated**è¡¨ç¤ºç›¸æ¯”å¯¹ç…§ç»„ï¼Œå®éªŒç»„ä¸­çš„ç”²åŸºåŒ–Cæ›´å¤šï¼›**hypomethylated**åˆ™ç›¸åï¼Œè¡¨ç¤ºå®éªŒç»„ä¸­çš„ç”²åŸºåŒ–Cæ¯”å¯¹ç…§ç»„ä¸­å°‘ã€‚  
é‡‡ç”¨getMethylDiffå‡½æ•°æå–å·®å¼‚åˆ†æçš„ç»“æœï¼Œç”¨æ³•å¦‚ä¸‹
```
all = getMethylDiff(
		myDiff,
		difference = 25,  //è¿™ä¸ªä¸œè¥¿æ˜¯å·®å¼‚é˜ˆå€¼ï¼Œåªæœ‰å·®å¼‚å¤§äºé˜ˆå€¼æ—¶ï¼Œæ‰ä¼šä¿ç•™
		qvalue = 0.01,    //qå€¼ï¼Œå°äºå®ƒæ—¶æ‰ä¿ç•™
		type="all"        //è¿™ä¸ªå‚æ•°çš„å–å€¼èŒƒå›´ä¸ºall,hypomethylated,hypermethylatedï¼Œç”¨äºå‘Šè¯‰Rä æƒ³è¦æ˜¾ç¤ºé‚£éƒ¨åˆ†çš„ç»“æœ
		)
```
#### å·®å¼‚ç”²åŸºåŒ–åŒºåŸŸçš„åˆ†æ
åœ¨methylKitä¸­ï¼Œå®ƒçš„å·®å¼‚åˆ†ææ€»æ˜¯é’ˆå¯¹åˆå¹¶åçš„ç”²åŸºåŒ–è¡¨è¾¾è°±ï¼Œå¦‚æœä½ çš„ç”²åŸºåŒ–è¡¨è¾¾è°±æ¯ä¸€è¡Œæ˜¯ä¸€ä¸ªç”²åŸºåŒ–ä½ç‚¹ï¼Œé‚£ä¹ˆå·®å¼‚åˆ†æçš„ç»“æœå°±æ˜¯å·®å¼‚ç”²åŸºåŒ–ä½ç‚¹ï¼›å¦‚æœä½ çš„è¡¨è¾¾è°±æ¯ä¸€è¡Œæ˜¯ä¸€ä¸ªç”²åŸºåŒ–åŒºåŸŸï¼Œé‚£ä¹ˆå·®å¼‚åˆ†æçš„ç»“æœå°±æ˜¯å·®å¼‚ç”²åŸºåŒ–åŒºåŸŸã€‚ä¸Šé¢çš„ä¾‹å­éƒ½æ˜¯é’ˆå¯¹å·®å¼‚ç”²åŸºåŒ–ä½ç‚¹çš„ï¼Œä¸‹é¢çœ‹ä¸‹å·®å¼‚ç”²åŸºåŒ–åŒºåŸŸçš„åˆ†æã€‚

é¦–å…ˆé‡åˆ°çš„é—®é¢˜å°±æ˜¯ç”²åŸºåŒ–åŒºåŸŸå¦‚ä½•ç•Œå®šï¼Œåœ¨methylKitä¸­ï¼ŒæŒ‰ç…§æ»‘åŠ¨çª—å£çš„æ–¹å¼å®šä¹‰ç”²åŸºåŒ–åŒºåŸŸï¼Œé»˜è®¤çª—å£å¤§å°ä¸º10000 bp ï¼Œæ­¥é•¿ä¸º1000bp,é€šè¿‡**tileMethylCounts**å‡½æ•°å®ç°ã€‚

å®Œæ•´çš„å·®å¼‚ç”²åŸºåŒ–åŒºåŸŸåˆ†æçš„ä»£ç å¦‚ä¸‹ï¼š
```
//ä»¥ä¸‹æ­¥éª¤æ˜¯è¯»å–å®Œæ ·å“æ–‡ä»¶ä»¥ååšçš„äº‹
regions = tileMethylCounts(myobj,win.size=1000,step.size=1000)
meth = unite(regions,destrand=FALSE)
myDiff = calculateDiffMeth(meth)
all = getMethylDiff(
		myDiff,
		difference = 25,  
		qvalue = 0.01,    
		type="all"        
		)
head(all)
```
